# –ü–∞—Ä—Å–µ—Ä –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä–∞: –ü–æ–¥—Ä–æ–±–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ

## üìö –ì–ª–æ—Å—Å–∞—Ä–∏–π –∫–ª—é—á–µ–≤—ã—Ö —Ç–µ—Ä–º–∏–Ω–æ–≤

| –¢–µ—Ä–º–∏–Ω | –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ |
|--------|-------------|
| **–ü–∞—Ä—Å–µ—Ä** | –ö–æ–º–ø–æ–Ω–µ–Ω—Ç –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä–∞, –ø—Ä–µ–æ–±—Ä–∞–∑—É—é—â–∏–π –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Ç–æ–∫–µ–Ω–æ–≤ –≤ –∞–±—Å—Ç—Ä–∞–∫—Ç–Ω–æ–µ —Å–∏–Ω—Ç–∞–∫—Å–∏—á–µ—Å–∫–æ–µ –¥–µ—Ä–µ–≤–æ. |
| **PEG** | Parsing Expression Grammar - —Ñ–æ—Ä–º–∞–ª—å–Ω–∞—è –≥—Ä–∞–º–º–∞—Ç–∏–∫–∞ –¥–ª—è –æ–ø–∏—Å–∞–Ω–∏—è —Å–∏–Ω—Ç–∞–∫—Å–∏—á–µ—Å–∫–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞. |
| **–†–µ–∫—É—Ä—Å–∏–≤–Ω—ã–π —Å–ø—É—Å–∫** | –¢–µ—Ö–Ω–∏–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞, –æ—Å–Ω–æ–≤–∞–Ω–Ω–∞—è –Ω–∞ –≤–∑–∞–∏–º–Ω—ã—Ö —Ä–µ–∫—É—Ä—Å–∏–≤–Ω—ã—Ö –≤—ã–∑–æ–≤–∞—Ö —Ñ—É–Ω–∫—Ü–∏–π –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –Ω–µ—Ç–µ—Ä–º–∏–Ω–∞–ª—å–Ω–æ–≥–æ —Å–∏–º–≤–æ–ª–∞ –≥—Ä–∞–º–º–∞—Ç–∏–∫–∏. |
| **–£–ø–æ—Ä—è–¥–æ—á–µ–Ω–Ω—ã–π –≤—ã–±–æ—Ä** | –ú–µ—Ö–∞–Ω–∏–∑–º –≤ PEG, –ø—Ä–∏ –∫–æ—Ç–æ—Ä–æ–º –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã —Ä–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞—é—Ç—Å—è –≤ –ø–æ—Ä—è–¥–∫–µ –∏—Ö –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è (–≤ –æ—Ç–ª–∏—á–∏–µ –æ—Ç –ö–°-–≥—Ä–∞–º–º–∞—Ç–∏–∫). |
| **–°–∏–Ω—Ç–∞–∫—Å–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑** | –ü—Ä–æ—Ü–µ—Å—Å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö —Å–æ–≥–ª–∞—Å–Ω–æ —Ñ–æ—Ä–º–∞–ª—å–Ω–æ–π –≥—Ä–∞–º–º–∞—Ç–∏–∫–µ. |
| **–ì—Ä–∞–º–º–∞—Ç–∏–∫–∞** | –§–æ—Ä–º–∞–ª—å–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–∞ —è–∑—ã–∫–∞ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è. |
| **–î–µ—Ä–µ–≤–æ —Ä–∞–∑–±–æ—Ä–∞** | –î—Ä–µ–≤–æ–≤–∏–¥–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞, –æ—Ç—Ä–∞–∂–∞—é—â–∞—è —Å–∏–Ω—Ç–∞–∫—Å–∏—á–µ—Å–∫—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É –≤—Ö–æ–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏ —Å–æ–≥–ª–∞—Å–Ω–æ –≥—Ä–∞–º–º–∞—Ç–∏–∫–µ. |
| **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–≤** | –ü—Ä–∞–≤–∏–ª–∞, –æ–ø—Ä–µ–¥–µ–ª—è—é—â–∏–µ –ø–æ—Ä—è–¥–æ–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –æ–ø–µ—Ä–∞—Ü–∏–π –≤ –≤—ã—Ä–∞–∂–µ–Ω–∏—è—Ö. |
| **–ê—Å—Å–æ—Ü–∏–∞—Ç–∏–≤–Ω–æ—Å—Ç—å** | –ü—Ä–∞–≤–∏–ª–æ, –æ–ø—Ä–µ–¥–µ–ª—è—é—â–µ–µ –ø–æ—Ä—è–¥–æ–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–≤ —Å –æ–¥–∏–Ω–∞–∫–æ–≤—ã–º –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–º. |
| **–ù–µ—Ç–µ—Ä–º–∏–Ω–∞–ª—å–Ω—ã–π —Å–∏–º–≤–æ–ª** | –≠–ª–µ–º–µ–Ω—Ç –≥—Ä–∞–º–º–∞—Ç–∏–∫–∏, –∫–æ—Ç–æ—Ä—ã–π –º–æ–∂–µ—Ç –±—ã—Ç—å –∑–∞–º–µ–Ω–µ–Ω —Å–æ–≥–ª–∞—Å–Ω–æ –ø—Ä–∞–≤–∏–ª–∞–º –≥—Ä–∞–º–º–∞—Ç–∏–∫–∏. |

## üîÑ –ú–µ—Å—Ç–æ –ø–∞—Ä—Å–µ—Ä–∞ –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏

### –í–∏–∑—É–∞–ª—å–Ω—ã–π –ø–æ—Ç–æ–∫ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏

```dot
digraph CompilationPipeline {
    rankdir=LR;
    node [shape=box, style=filled, color=lightblue];
    
    source [label="–ò—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥\nint main() { return 42; }"];
    lexer [label="–õ–µ–∫—Å–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä"];
    parser [label="–°–∏–Ω—Ç–∞–∫—Å–∏—á–µ—Å–∫–∏–π\n–∞–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä (–ü–∞—Ä—Å–µ—Ä)", color=gold, style=filled];
    ast [label="–ê–±—Å—Ç—Ä–∞–∫—Ç–Ω–æ–µ\n–°–∏–Ω—Ç–∞–∫—Å–∏—á–µ—Å–∫–æ–µ –î–µ—Ä–µ–≤–æ"];
    semantic [label="–°–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–π\n–∞–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä"];
    optimization [label="–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è"];
    codegen [label="–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–æ–¥–∞"];
    
    source -> lexer [label="–°–∏–º–≤–æ–ª—ã"];
    lexer -> parser [label="–¢–æ–∫–µ–Ω—ã"];
    parser -> ast [label="–°–æ–∑–¥–∞–Ω–∏–µ AST", color=red, penwidth=2.0];
    ast -> semantic;
    semantic -> optimization;
    optimization -> codegen;
    
    subgraph cluster_parser {
        label="–í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –ø–∞—Ä—Å–µ—Ä–∞";
        style=dashed;
        color=gray;
        
        input [label="–í—Ö–æ–¥–Ω—ã–µ —Ç–æ–∫–µ–Ω—ã", shape=ellipse];
        grammar [label="–ü—Ä–∞–≤–∏–ª–∞ –≥—Ä–∞–º–º–∞—Ç–∏–∫–∏"];
        parsing_engine [label="–ú–µ—Ö–∞–Ω–∏–∑–º —Ä–∞–∑–±–æ—Ä–∞"];
        tree_builder [label="–ü–æ—Å—Ç—Ä–æ–∏—Ç–µ–ª—å AST"];
        output [label="–î–µ—Ä–µ–≤–æ AST", shape=ellipse];
        
        input -> grammar -> parsing_engine -> tree_builder -> output;
    }
}
```

### –°—Ö–µ–º–∞ –ø—Ä–æ—Ü–µ—Å—Å–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ –í—Ö–æ–¥–Ω—ã–µ —Ç–æ–∫–µ–Ω—ã:                   ‚îÇ
‚îÇ [KW:int] [ID:main] [(] [)] [{] ... ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ –°–∏–Ω—Ç–∞–∫—Å–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä         ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ –ê–±—Å—Ç—Ä–∞–∫—Ç–Ω–æ–µ —Å–∏–Ω—Ç–∞–∫—Å–∏—á–µ—Å–∫–æ–µ –¥–µ—Ä–µ–≤–æ ‚îÇ
‚îÇ                                   ‚îÇ
‚îÇ          Program                  ‚îÇ
‚îÇ             ‚îÇ                     ‚îÇ
‚îÇ          Function                 ‚îÇ
‚îÇ          /  ‚îÇ  \                  ‚îÇ
‚îÇ       int  main  Block            ‚îÇ
‚îÇ                    ‚îÇ              ‚îÇ
‚îÇ                  Return           ‚îÇ
‚îÇ                    ‚îÇ              ‚îÇ
‚îÇ                   42              ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

## üìù –ü–æ—à–∞–≥–æ–≤–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –¥–ª—è –Ω–∞—á–∏–Ω–∞—é—â–∏—Ö —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤

### –ë–∞–∑–æ–≤—ã–µ –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏ –Ω–∞ –ø—Ä–æ—Å—Ç—ã—Ö –ø—Ä–∏–º–µ—Ä–∞—Ö

1. **–ß—Ç–æ —Ç–∞–∫–æ–µ –ø–∞—Ä—Å–∏–Ω–≥?**
   
   –ü—Ä–µ–¥—Å—Ç–∞–≤—å—Ç–µ, —á—Ç–æ –≤—ã —Ä–∞–∑–±–∏—Ä–∞–µ—Ç–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ:
   ```
   "–°—Ç—É–¥–µ–Ω—Ç —á–∏—Ç–∞–µ—Ç –∫–Ω–∏–≥—É."
   ```
   
   –í–∞—à –º–æ–∑–≥ —Ä–∞–∑–±–∏–≤–∞–µ—Ç –µ–≥–æ –Ω–∞ —á–∞—Å—Ç–∏:
   - –ü–æ–¥–ª–µ–∂–∞—â–µ–µ: "–°—Ç—É–¥–µ–Ω—Ç"
   - –°–∫–∞–∑—É–µ–º–æ–µ: "—á–∏—Ç–∞–µ—Ç"
   - –î–æ–ø–æ–ª–Ω–µ–Ω–∏–µ: "–∫–Ω–∏–≥—É"
   
   –ü–∞—Ä—Å–µ—Ä –¥–µ–ª–∞–µ—Ç —Ç–æ –∂–µ —Å–∞–º–æ–µ —Å –∫–æ–¥–æ–º!

2. **–û—Ç —Ç–æ–∫–µ–Ω–æ–≤ –∫ —Å—Ç—Ä—É–∫—Ç—É—Ä–µ**

   –ü—Ä–∏–º–µ—Ä —Å –ø—Ä–æ—Å—Ç—ã–º –∞—Ä–∏—Ñ–º–µ—Ç–∏—á–µ—Å–∫–∏–º –≤—ã—Ä–∞–∂–µ–Ω–∏–µ–º:
   ```
   2 + 3 * 4
   ```
   
   –¢–æ–∫–µ–Ω—ã: `[2]` `[+]` `[3]` `[*]` `[4]`
   
   –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ (AST):
   ```
        +
       / \
      2   *
         / \
        3   4
   ```

3. **–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–∞—Ä—Å–µ—Ä?**

   - –ü–æ–ª—É—á–∞–µ—Ç —Ç–æ–∫–µ–Ω—ã –æ—Ç –ª–µ–∫—Å–µ—Ä–∞
   - –ü—Ä–∏–º–µ–Ω—è–µ—Ç –ø—Ä–∞–≤–∏–ª–∞ –≥—Ä–∞–º–º–∞—Ç–∏–∫–∏
   - –°—Ç—Ä–æ–∏—Ç –¥–µ—Ä–µ–≤–æ —Ä–∞–∑–±–æ—Ä–∞
   - –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç –µ–≥–æ –≤ AST

### –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–π –ø—Ä–∏–º–µ—Ä –¥–ª—è –Ω–æ–≤–∏—á–∫–æ–≤

#### –ò—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥
```clojure
(defn parse-simple-expression [tokens]
  (let [left (parse-number (first tokens))
        op (second tokens)
        right (parse-number (nth tokens 2))]
    {:type :expression
     :operator op
     :left left
     :right right}))
```

#### –ü–æ—à–∞–≥–æ–≤—ã–π —Ä–∞–∑–±–æ—Ä
1. –ë–µ—Ä–µ–º —Ç–æ–∫–µ–Ω—ã: `[2]` `[+]` `[3]`
2. –ü–∞—Ä—Å–∏–º –ª–µ–≤–æ–µ —á–∏—Å–ª–æ: `{:type :number, :value 2}`
3. –ò–∑–≤–ª–µ–∫–∞–µ–º –æ–ø–µ—Ä–∞—Ç–æ—Ä: `+`
4. –ü–∞—Ä—Å–∏–º –ø—Ä–∞–≤–æ–µ —á–∏—Å–ª–æ: `{:type :number, :value 3}`
5. –°–æ–∑–¥–∞–µ–º —É–∑–µ–ª –≤—ã—Ä–∞–∂–µ–Ω–∏—è

#### –†–µ–∑—É–ª—å—Ç–∞—Ç
```clojure
{:type :expression
 :operator "+"
 :left {:type :number, :value 2}
 :right {:type :number, :value 3}}
```

## üß† –û–±–∑–æ—Ä –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã –ø–∞—Ä—Å–µ—Ä–∞

### –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏
- **–¢–∏–ø –ø–∞—Ä—Å–µ—Ä–∞**: Parsing Expression Grammar (PEG)
- **–Ø–∑—ã–∫ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏**: Clojure
- **–¶–µ–ª—å**: –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ —Ç–æ–∫–µ–Ω–æ–≤ –≤ –∞–±—Å—Ç—Ä–∞–∫—Ç–Ω–æ–µ —Å–∏–Ω—Ç–∞–∫—Å–∏—á–µ—Å–∫–æ–µ –¥–µ—Ä–µ–≤–æ (AST)

### –£–ø—Ä–æ—â–µ–Ω–Ω–∞—è –º–æ–¥–µ–ª—å —Ä–∞–±–æ—Ç—ã PEG-–ø–∞—Ä—Å–µ—Ä–∞

```dot
digraph PEGParserModel {
    rankdir=TD;
    node [shape=box, style=filled, color=lightblue];
    
    start [label="–ù–∞—á–∞–ª–æ –ø–∞—Ä—Å–∏–Ω–≥–∞", shape=ellipse];
    token_stream [label="–ü–æ—Ç–æ–∫ —Ç–æ–∫–µ–Ω–æ–≤"];
    rule_selection [label="–í—ã–±–æ—Ä –ø—Ä–∞–≤–∏–ª–∞ –≥—Ä–∞–º–º–∞—Ç–∏–∫–∏"];
    matching [label="–°–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ —Å –ø–∞—Ç—Ç–µ—Ä–Ω–æ–º"];
    choice [label="–£–ø–æ—Ä—è–¥–æ—á–µ–Ω–Ω—ã–π –≤—ã–±–æ—Ä", shape=diamond];
    success [label="–£—Å–ø–µ—à–Ω–æ–µ —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ", color=lightgreen];
    failure [label="–ù–µ—É–¥–∞—á–Ω–æ–µ —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ", color=lightcoral];
    backtracking [label="–í–æ–∑–≤—Ä–∞—Ç (backtracking)"];
    ast_building [label="–ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ AST"];
    end [label="–ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ –ø–∞—Ä—Å–∏–Ω–≥–∞", shape=ellipse];
    
    start -> token_stream -> rule_selection -> matching;
    matching -> choice;
    choice -> success [label="–ù–∞—à–ª–∏"];
    choice -> failure [label="–ù–µ –Ω–∞—à–ª–∏"];
    failure -> backtracking -> rule_selection [label="–ü—Ä–æ–±—É–µ–º –¥—Ä—É–≥–æ–µ –ø—Ä–∞–≤–∏–ª–æ"];
    success -> ast_building -> end;
}
```

## üì¶ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –º–æ–¥—É–ª—è

### –ö–ª—é—á–µ–≤—ã–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞ –∏–º–µ–Ω
```clojure
(ns compiler.parser
  (:require [clojure.string :as str]
            [compiler.ast :refer [->Num ->BinaryOp ...]])
```

### –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
1. **–í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏**
   - `match-token`: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–æ–∫–µ–Ω–æ–≤
   - `match-type`: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–∏–ø–∞ —Ç–æ–∫–µ–Ω–∞
   - `match-value`: –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–Ω–∞—á–µ–Ω–∏—è —Ç–æ–∫–µ–Ω–∞

2. **–ü–∞—Ä—Å–∏–Ω–≥ –ø—Ä–∏–º–∏—Ç–∏–≤–æ–≤**
   - `parse-number`: –†–∞–∑–±–æ—Ä —á–∏—Å–ª–æ–≤—ã—Ö –ª–∏—Ç–µ—Ä–∞–ª–æ–≤
   - `parse-variable`: –†–∞–∑–±–æ—Ä –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
   - `parse-parens`: –†–∞–∑–±–æ—Ä –≤—ã—Ä–∞–∂–µ–Ω–∏–π –≤ —Å–∫–æ–±–∫–∞—Ö

3. **–ü–∞—Ä—Å–∏–Ω–≥ –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–≤**
   - `parse-binary-op`: –ë–∏–Ω–∞—Ä–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏
   - `parse-unary-op`: –£–Ω–∞—Ä–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏

4. **–ü–∞—Ä—Å–∏–Ω–≥ —É–ø—Ä–∞–≤–ª—è—é—â–∏—Ö –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–π**
   - `parse-if`: –£—Å–ª–æ–≤–Ω—ã–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä—ã
   - `parse-while`: –¶–∏–∫–ª—ã while
   - `parse-for`: –¶–∏–∫–ª—ã for
   - `parse-return`: –û–ø–µ—Ä–∞—Ç–æ—Ä—ã –≤–æ–∑–≤—Ä–∞—Ç–∞

## üîç –ê–ª–≥–æ—Ä–∏—Ç–º —Ä–∞–±–æ—Ç—ã –ø–∞—Ä—Å–µ—Ä–∞

### –≠—Ç–∞–ø 1: –õ–µ–∫—Å–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑
```clojure
(defn parse [input]
  (let [tokens (filterv 
                 (fn [token] 
                   (not (or 
                          (= (first token) :comment)
                          (= (first token) :whitespace)
                          (= (first token) :comment_multiline))))
                 (tokenize input))]
    ;; –î–∞–ª—å–Ω–µ–π—à–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ç–æ–∫–µ–Ω–æ–≤
    ))
```

#### –®–∞–≥–∏ –ª–µ–∫—Å–∏—á–µ—Å–∫–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞
1. –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –≤—Ö–æ–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏ –≤ –ø–æ—Ç–æ–∫ —Ç–æ–∫–µ–Ω–æ–≤
2. –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è —Å–ª—É–∂–µ–±–Ω—ã—Ö —Ç–æ–∫–µ–Ω–æ–≤ (–∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏, –ø—Ä–æ–±–µ–ª—ã)

### –≠—Ç–∞–ø 2: –°–∏–Ω—Ç–∞–∫—Å–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑
```clojure
(defn parse-statement [tokens]
  (or (parse-if tokens)
      (parse-while tokens)
      (parse-for tokens)
      (parse-return tokens)
      (parse-block tokens)
      (parse-expr tokens)))
```

#### –°—Ç—Ä–∞—Ç–µ–≥–∏—è —Ä–∞–∑–±–æ—Ä–∞
- –†–µ–∫—É—Ä—Å–∏–≤–Ω—ã–π —Å–ø—É—Å–∫
- –£–ø–æ—Ä—è–¥–æ—á–µ–Ω–Ω—ã–π –≤—ã–±–æ—Ä (ordered choice)
- –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤–∏–ª –ø–∞—Ä—Å–∏–Ω–≥–∞

### –≠—Ç–∞–ø 3: –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ AST
```clojure
(defn parse-complex-expr [tokens]
  ;; –°–ª–æ–∂–Ω—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è AST
  ;; –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞ –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–≤
  )
```

## üéì –ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –º–æ–¥–µ–ª—å –ø–∞—Ä—Å–µ—Ä–∞

### –§–æ—Ä–º–∞–ª—å–Ω–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ PEG-–≥—Ä–∞–º–º–∞—Ç–∏–∫–∏

\[ 
\text{PEG} = (V, \Sigma, R, e_s)
\]

–≥–¥–µ:
- \( V \) - –∫–æ–Ω–µ—á–Ω–æ–µ –º–Ω–æ–∂–µ—Å—Ç–≤–æ –Ω–µ—Ç–µ—Ä–º–∏–Ω–∞–ª—å–Ω—ã—Ö —Å–∏–º–≤–æ–ª–æ–≤
- \( \Sigma \) - –∫–æ–Ω–µ—á–Ω–æ–µ –º–Ω–æ–∂–µ—Å—Ç–≤–æ —Ç–µ—Ä–º–∏–Ω–∞–ª—å–Ω—ã—Ö —Å–∏–º–≤–æ–ª–æ–≤, \( V \cap \Sigma = \emptyset \)
- \( R: V \rightarrow \mathcal{E} \) - –∫–æ–Ω–µ—á–Ω–æ–µ –º–Ω–æ–∂–µ—Å—Ç–≤–æ –ø—Ä–∞–≤–∏–ª
- \( e_s \in \mathcal{E} \) - –≤—ã—Ä–∞–∂–µ–Ω–∏–µ —Ä–∞–∑–±–æ—Ä–∞, –æ–±–æ–∑–Ω–∞—á–∞–µ–º–æ–µ —Å—Ç–∞—Ä—Ç–æ–≤—ã–º —Å–∏–º–≤–æ–ª–æ–º

### –û–ø–µ—Ä–∞—Ç–æ—Ä—ã –≤ PEG

| –û–ø–µ—Ä–∞—Ç–æ—Ä | –û–ø–∏—Å–∞–Ω–∏–µ | –ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –Ω–æ—Ç–∞—Ü–∏—è |
|----------|----------|------------------------|
| –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å | –°–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ e‚ÇÅ, –∑–∞—Ç–µ–º e‚ÇÇ | \( e_1 \cdot e_2 \) |
| –£–ø–æ—Ä—è–¥–æ—á–µ–Ω–Ω—ã–π –≤—ã–±–æ—Ä | –ü—Ä–æ–±—É–µ–º e‚ÇÅ, –µ—Å–ª–∏ –Ω–µ –ø–æ–ª—É—á–∏–ª–æ—Å—å - e‚ÇÇ | \( e_1 / e_2 \) |
| –ó–∞–º—ã–∫–∞–Ω–∏–µ –ö–ª–∏–Ω–∏ | –ù–æ–ª—å –∏–ª–∏ –±–æ–ª–µ–µ –≤—Ö–æ–∂–¥–µ–Ω–∏–π e | \( e* \) |
| –ü–æ–∑–∏—Ç–∏–≤–Ω–æ–µ –∑–∞–º—ã–∫–∞–Ω–∏–µ | –û–¥–Ω–æ –∏–ª–∏ –±–æ–ª–µ–µ –≤—Ö–æ–∂–¥–µ–Ω–∏–π e | \( e+ \) |
| –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ –≤—Ö–æ–∂–¥–µ–Ω–∏–µ | –ù–æ–ª—å –∏–ª–∏ –æ–¥–Ω–æ –≤—Ö–æ–∂–¥–µ–Ω–∏–µ e | \( e? \) |
| –ò-–ø—Ä–µ–¥–∏–∫–∞—Ç | –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–∞–ª–∏—á–∏–µ e –±–µ–∑ –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏—è | \( \&e \) |
| –ù–µ-–ø—Ä–µ–¥–∏–∫–∞—Ç | –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ e –±–µ–∑ –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏—è | \( !e \) |

### –í—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã –∏ —Å–ª–æ–∂–Ω–æ—Å—Ç—å

–í—Ä–µ–º–µ–Ω–Ω–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å PEG-–ø–∞—Ä—Å–µ—Ä–∞ –±–µ–∑ –º–µ–º–æ–∏–∑–∞—Ü–∏–∏:
\[ O(4^n) \]

–í—Ä–µ–º–µ–Ω–Ω–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å PEG-–ø–∞—Ä—Å–µ—Ä–∞ —Å –º–µ–º–æ–∏–∑–∞—Ü–∏–µ–π:
\[ O(n^3) \]

–ì–¥–µ \( n \) - –¥–ª–∏–Ω–∞ –≤—Ö–æ–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏.

–ü—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ–Ω–Ω–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å:
\[ O(n^2) \]

## üîÑ –î–∏–∞–≥—Ä–∞–º–º—ã –∫–æ–Ω–µ—á–Ω—ã—Ö –∞–≤—Ç–æ–º–∞—Ç–æ–≤ –¥–ª—è —É–ø—Ä–∞–≤–ª—è—é—â–∏—Ö —Å—Ç—Ä—É–∫—Ç—É—Ä

### 1. –ö–æ–Ω–µ—á–Ω—ã–π –∞–≤—Ç–æ–º–∞—Ç –¥–ª—è if-else

```dot
digraph IfElseDFA {
    rankdir=TB;
    node [shape=circle];
    
    start [label="–ù–∞—á–∞–ª–æ", shape=point];
    if_keyword [label="–ö–ª—é—á–µ–≤–æ–µ —Å–ª–æ–≤–æ if"];
    condition [label="–£—Å–ª–æ–≤–∏–µ"];
    true_branch [label="–ò—Å—Ç–∏–Ω–Ω–∞—è –≤–µ—Ç–≤—å"];
    false_branch [label="–õ–æ–∂–Ω–∞—è –≤–µ—Ç–≤—å (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)"];
    end [label="–ö–æ–Ω–µ—Ü", shape=doublecircle];

    start -> if_keyword;
    if_keyword -> condition [label="–†–∞–∑–±–æ—Ä"];
    condition -> true_branch [label="–£—Å–ª–æ–≤–∏–µ –∏—Å—Ç–∏–Ω–Ω–æ"];
    condition -> false_branch [label="–£—Å–ª–æ–≤–∏–µ –ª–æ–∂–Ω–æ"];
    true_branch -> end;
    false_branch -> end;
}
```

### 2. –ö–æ–Ω–µ—á–Ω—ã–π –∞–≤—Ç–æ–º–∞—Ç –¥–ª—è while

```dot
digraph WhileDFA {
    rankdir=TB;
    node [shape=circle];
    
    start [label="–ù–∞—á–∞–ª–æ", shape=point];
    while_keyword [label="–ö–ª—é—á–µ–≤–æ–µ —Å–ª–æ–≤–æ while"];
    condition [label="–£—Å–ª–æ–≤–∏–µ —Ü–∏–∫–ª–∞"];
    loop_body [label="–¢–µ–ª–æ —Ü–∏–∫–ª–∞"];
    iteration [label="–ò—Ç–µ—Ä–∞—Ü–∏—è"];
    end [label="–ö–æ–Ω–µ—Ü —Ü–∏–∫–ª–∞", shape=doublecircle];

    start -> while_keyword;
    while_keyword -> condition;
    condition -> loop_body [label="–£—Å–ª–æ–≤–∏–µ –∏—Å—Ç–∏–Ω–Ω–æ"];
    condition -> end [label="–£—Å–ª–æ–≤–∏–µ –ª–æ–∂–Ω–æ"];
    loop_body -> iteration;
    iteration -> condition [label="–í–æ–∑–≤—Ä–∞—Ç –∫ –ø—Ä–æ–≤–µ—Ä–∫–µ"];
}
```

## üå≤ –ë–æ–Ω—É—Å: –ü–æ–ª–µ–∑–Ω—ã–µ –¥–∏–∞–≥—Ä–∞–º–º—ã –¥–ª—è –ø–æ–Ω–∏–º–∞–Ω–∏—è

### –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ç–∏–ø–æ–≤ –ø–∞—Ä—Å–µ—Ä–æ–≤

```
LL  ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ  LR
‚Üë                            ‚Üë
–°–≤–µ—Ä—Ö—É-–≤–Ω–∏–∑                  –°–Ω–∏–∑—É-–≤–≤–µ—Ä—Ö
–†–µ–∫—É—Ä—Å–∏–≤–Ω—ã–π —Å–ø—É—Å–∫            –¢–∞–±–ª–∏—Ü—ã –ø–µ—Ä–µ—Ö–æ–¥–æ–≤
–ü—Ä–æ—â–µ –¥–ª—è –ø–æ–Ω–∏–º–∞–Ω–∏—è          –ë–æ–ª–µ–µ –º–æ—â–Ω—ã–µ
PEG –æ—Ç–Ω–æ—Å–∏—Ç—Å—è —Å—é–¥–∞           LALR –æ—Ç–Ω–æ—Å–∏—Ç—Å—è —Å—é–¥–∞
```

### –õ–µ—Å—Ç–Ω–∏—Ü–∞ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ –ø–∞—Ä—Å–µ—Ä–æ–≤

```
–°–ª–æ–∂–Ω–æ—Å—Ç—å   ‚îÇ         ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
—Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏  ‚îÇ         ‚îÇ  LR   ‚îÇ
            ‚îÇ         ‚îÇ       ‚îÇ
            ‚îÇ    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îê    ‚îÇ
            ‚îÇ    ‚îÇ LALR  ‚îÇ    ‚îÇ
            ‚îÇ    ‚îÇ       ‚îÇ    ‚îÇ
            ‚îÇ ‚îå‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îÇ    ‚îÇ
            ‚îÇ ‚îÇ  LL   ‚îÇ  ‚îÇ    ‚îÇ
            ‚îÇ ‚îÇ       ‚îÇ  ‚îÇ    ‚îÇ
            ‚îÇ ‚îî‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îê‚îÇ  ‚îÇ    ‚îÇ
            ‚îÇ    ‚îÇPEG‚îÇ‚îÇ  ‚îÇ    ‚îÇ
            ‚îÇ    ‚îÇ   ‚îÇ‚îÇ  ‚îÇ    ‚îÇ
            ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚î¥‚î¥‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îò
               –í—ã—Ä–∞–∑–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
```

### –ö–ª—é—á–µ–≤—ã–µ —à–∞–≥–∏ –æ—Å–≤–æ–µ–Ω–∏—è
1. ‚úÖ –ò–∑—É—á–∏—Ç–µ –±–∞–∑–æ–≤—É—é —Ç–µ–æ—Ä–∏—é —Ñ–æ—Ä–º–∞–ª—å–Ω—ã—Ö –≥—Ä–∞–º–º–∞—Ç–∏–∫
2. ‚úÖ –†–µ–∞–ª–∏–∑—É–π—Ç–µ –ø—Ä–æ—Å—Ç–æ–π –ø–∞—Ä—Å–µ—Ä –¥–ª—è –∞—Ä–∏—Ñ–º–µ—Ç–∏—á–µ—Å–∫–∏—Ö –≤—ã—Ä–∞–∂–µ–Ω–∏–π
3. ‚úÖ –ù–∞—É—á–∏—Ç–µ—Å—å –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–≤
4. ‚úÖ –†–∞—Å—à–∏—Ä—å—Ç–µ –ø–∞—Ä—Å–µ—Ä –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
5. ‚úÖ –î–æ–±–∞–≤—å—Ç–µ –ø–æ–¥–¥–µ—Ä–∂–∫—É —É–ø—Ä–∞–≤–ª—è—é—â–∏—Ö –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–π

## üìö –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–∞—è –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä–∞
1. "Parsing Techniques" - Dick Grune
2. "Modern Compiler Implementation" - Andrew W. Appel
3. "Language Implementation Patterns" - Terence Parr

## üîó –°—Å—ã–ª–∫–∏ –Ω–∞ –∏—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥

- [GitHub: Clojure Compiler Project](https://github.com/Sehktel/compiler)
- [–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø—Ä–æ–µ–∫—Ç–∞](https://Sehktel.github.io/compiler-docs)

---

**–ó–∞–º–µ—á–∞–Ω–∏–µ –¥–ª—è –Ω–∞—á–∏–Ω–∞—é—â–∏—Ö**: –ü–∞—Ä—Å–∏–Ω–≥ - —ç—Ç–æ –Ω–µ –ø—Ä–æ—Å—Ç–æ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –∑–∞–¥–∞—á–∞, –Ω–æ –∏—Å–∫—É—Å—Å—Ç–≤–æ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–∏ –∞–±—Å—Ç—Ä–∞–∫—Ü–∏–π. –ù–µ –±–æ–π—Ç–µ—Å—å —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –∏ –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ –Ω–∞—Ä–∞—â–∏–≤–∞—Ç—å —Å–≤–æ–∏ –∑–Ω–∞–Ω–∏—è! üöÄ